!function(){"use strict";angular.module("kt.common").directive("ktSlotMachine",["$timeout",function(a){return{restrict:"AE",scope:{effect:"@",className:"@",delay:"@",version:"@",placeholds:"="},replace:!0,templateUrl:"common/directives/slot-machine/template.html",controller:["$scope",function(a){a.getArray=function(a){return new Array(a)},a.slots=[{name:"0",destination:12,duration:1.4,state:12,delay:.5,placehold:"4"},{name:"0",destination:12,duration:1.6,state:12,delay:.55,placehold:"2"},{name:"0",destination:12,duration:1.8,state:12,delay:.6,placehold:"."},{name:"0",destination:12,duration:2,state:12,delay:.65,placehold:"0"},{name:"0",destination:12,state:12,duration:2.2,delay:.7,placehold:"6"}]}],link:function(b,c,d){function e(a){_.map(f,function(b,c){return b.placehold=a[c]||b.placehold,b})}var f=b.slots,g=b.placeholds||[];e(g),b.$watch("placeholds",function(a,b){e(a)});var h=parseInt(d.delay||.1),i=d.emitBy||"",j=d.slickElem||"",k=$(c).closest(".slick-item").index();a(function(){var b=c.find(".slot");b.attr("data-state","0"),b.each(function(a){var b=f[a];$(this).css({"animation-duration":b.duration+"s","animation-delay":b.delay+h+"s","animation-name":"kt-roll-"+b.destination})}),b.on("oanimationend animationend webkitAnimationEnd MSAnimationEnd mozAnimationEnd",function(){var a=f[$(this).index()];$(this).attr("data-state",a.state)}),b.css("animation-timing-function","cubic-bezier(0.57, -0.08, 0.32, 1.28)"),b.addClass("roll"),"slick"===i&&j&&$(j).length&&($(j).on("beforeChange",function(a,c,d,e){d===k&&b.each(function(){$(this).attr("data-state",0)})}),$(j).on("afterChange",function(c,d,e){e===k&&b.each(function(b){var c=this;a(function(){var a=f[$(c).index()];$(c).attr("data-state",a.state)},200*b+800,!1)})}))},1e3,!1)}}}])}();