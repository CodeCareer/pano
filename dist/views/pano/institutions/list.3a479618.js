!function(){"use strict";angular.module("kt.pano").controller("ktInsitutionListCtrl",["$scope","$rootScope","$state","$location","ktSweetAlert","ktDataHelper","ktInsitutionRepositoriesService",function(a,b,c,d,e,f,g){var h=a.shared,i=d.search(),j=["name","co_institution"];a.shared.placeholderText="输入关键字，如机构名称、主要合作机构",a.gotoDetail=function(a){var b=c.href("pano.institutions.detail",{id:a.name,dimension:"0"===a.type?"from":"mapped_exchange"});window.open(b,"_blank")},a.gotoProducts=function(a,b){var d={};"0"===a.type?d.from_eq=a.name:"1"===a.type&&(d.exchange_eq=a.name);var e=c.href("am"===b?"pano.products.assetManage":"pano.products.obligatoryRight",d);window.open(e,"_blank")},a.rateSortTitle=function(){return"rate"===i.sort_by?"asc"===i.order?"点击近七日收益率由大到小排序":"点击取消近七日收益率排序":"点击近七日收益率由小到大排序"},a.amountSortTitle=function(){return"sum_amount"===i.sort_by?"asc"===i.order?"点击近七日发行量由大到小排序":"点击取消近七日发行量排序":"点击近七日发行量由小到大排序"},h._params.totalItems=0,$.extend(h.params,i),h._params.page=h.params.page,f.pruneDirtyParams(h.params,i,["order","sort_by","search_fields[]"]),f.intFitlerStatus(a,i),h.filterDatas?(h.filters=h.filterDatas.filters,f.filterInit(h.filters)(h.params)):(h.filterDatas={filters:[{name:"机构类型",value:"institution_type",options:[["互联网金融平台","0"],["挂牌场所","1"]]}]},h.filters=h.filterDatas.filters,f.filterInit(h.filters)(h.params)),g.get(f.cutDirtyParams(h.params),function(b){a.institutions=b.institutions,a.updateTime=b.latest_uptime,b.summary.find.search_results&&(b.summary.find.search_results=_.filter(b.summary.find.search_results,function(a){return 0!==a.search_count}),b.summary.find.search_results.sort(function(a,b){return _.indexOf(j,a.name)>_.indexOf(j,b.name)?1:_.indexOf(j,a.name)<_.indexOf(j,b.name)?-1:0})),a.summary=b.summary,h._params.totalItems=b.summary.find.count,h._params.totalPages=_.ceil(b.summary.find.count/h.params.per_page),h.params.page=i.page||h.params.page,a.pageChanged=function(){d.search("page",h.params.page)}})}])}();